<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Redis入坑笔记 | 浊客的个人博客</title><meta name="keywords" content="redis"><meta name="author" content="浊客"><meta name="copyright" content="浊客"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Redis入坑笔记  什么是Redis  Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker. It supports data structures such as strings, hashes, lists,">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis入坑笔记">
<meta property="og:url" content="http://example.com/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="浊客的个人博客">
<meta property="og:description" content="Redis入坑笔记  什么是Redis  Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker. It supports data structures such as strings, hashes, lists,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://download.logo.wine/logo/Redis/Redis-Logo.wine.png">
<meta property="article:published_time" content="2020-11-22T16:04:02.000Z">
<meta property="article:modified_time" content="2021-01-19T15:41:59.254Z">
<meta property="article:author" content="浊客">
<meta property="article:tag" content="redis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://download.logo.wine/logo/Redis/Redis-Logo.wine.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-01-19 23:41:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2020/06/27/nIY1saEj87i5Vg9.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://download.logo.wine/logo/Redis/Redis-Logo.wine.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">浊客的个人博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">Redis入坑笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-22T16:04:02.000Z" title="发表于 2020-11-23 00:04:02">2020-11-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-19T15:41:59.254Z" title="更新于 2021-01-19 23:41:59">2021-01-19</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="redis入坑笔记"><a class="markdownIt-Anchor" href="#redis入坑笔记"></a> Redis入坑笔记</h1>
<h2 id="什么是redis查看源图像"><a class="markdownIt-Anchor" href="#什么是redis查看源图像"></a> 什么是Redis<img src="https://download.logo.wine/logo/Redis/Redis-Logo.wine.png" alt="查看源图像" /></h2>
<blockquote>
<p>Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker. It supports data structures such as strings, hashes, lists, sets, sorted sets with range queries, bitmaps, hyperloglogs, geospatial indexes with radius queries and streams. Redis has built-in replication, Lua scripting, LRU eviction, transactions and different levels of on-disk persistence, and provides high availability via Redis Sentinel and automatic partitioning with Redis Cluster</p>
</blockquote>
<p>以上是Redis官网对redis的简介，可以看出这是一个基于内存的非关系型的数据库，但是作用不仅仅是数据库还可以作为缓存以及消息的中间件。多种数据类型。虽然是基于内存的数据库也支持磁盘持久化。并且可以提供高可用的一些方案。</p>
<h2 id="redis安装"><a class="markdownIt-Anchor" href="#redis安装"></a> Redis安装</h2>
<h3 id="windows安装"><a class="markdownIt-Anchor" href="#windows安装"></a> Windows安装</h3>
<p>在Window下的安装较为简单，在<a target="_blank" rel="noopener" href="https://github.com/microsoftarchive/redis/releases">Windows</a> 页面选择最新版本下载。安装即可 ()</p>
<h3 id="linux安装"><a class="markdownIt-Anchor" href="#linux安装"></a> Linux安装</h3>
<p>Linux 可以通过docker安装或者编译安装 ，相对来说docker安装比较方便。</p>
<h4 id="docker安装"><a class="markdownIt-Anchor" href="#docker安装"></a> docker安装</h4>
<p>拉取镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis:latest</span><br></pre></td></tr></table></figure>
<p>运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name redis-test -p 6379:6379 redis</span><br></pre></td></tr></table></figure>
<h4 id="编译安装"><a class="markdownIt-Anchor" href="#编译安装"></a> 编译安装</h4>
<p>安装redis之前先安装C++编译环境，gcc</p>
<p>安装gcc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc-c++</span><br></pre></td></tr></table></figure>
<p>去官网下载使用wget命令获取redis最新压缩包 ，官网也提供了安装命令。tar命令解压（建议解压到opt路径下），cd到解压的路径，使用make命令编译。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-6.0.8.tar.gz</span><br><span class="line">mv  redis-6.0.8.tar.gz /opt</span><br><span class="line">tar -xzf redis-6.0.8.tar.gz</span><br><span class="line">cd redis-6.0.8</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>程序已经默认安装好在/usr/loacl/bin下了</p>
<h3 id="启动"><a class="markdownIt-Anchor" href="#启动"></a> 启动</h3>
<p>redis 默认并不是后台启动 ，需要修改config中 <strong>daemonize</strong>属性改为yes</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server  redis.config</span><br></pre></td></tr></table></figure>
<h3 id="使用redis客户端连接"><a class="markdownIt-Anchor" href="#使用redis客户端连接"></a> 使用redis客户端连接</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reids-cli -h 127.0.0.1  -p 6379</span><br></pre></td></tr></table></figure>
<p>cli连接后关闭redis</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown</span><br></pre></td></tr></table></figure>
<h2 id="常用命令"><a class="markdownIt-Anchor" href="#常用命令"></a> 常用命令</h2>
<ul>
<li>
<p>查询所有key</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keys *</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h2>
<p>Redis底层数据结构一共有 6 种，分别是简单动态字符串、双向链表、压缩列表、哈希表、跳表和整数数组。利用各个数据结构不同的特性，在不同的场景下，动态组成了了各种数据类型，对应关系如下图所示：</p>
<p><img src="https://gitee.com/xiaozhuo_Q/images/raw/master/blog/image-20210113220722832.png" alt="image-20210113220722832" /></p>
<p>Redis作为一个典型的键值对数据库，我们先来看看它的键值对都是如何保存的。<br />
首先Redis服务器中每个服务器都是存在RedisService中长度为dbnum（默认为16）的RedisDB数组中，所以redis默认拥有16个数据库的。<br />
RedisDB数组中每个数据库使用Redisdb结构来表示，而RedisDB数据库结构下的dict字典就保存该数据库所有的键值对信息；</p>
<p><img src="https://gitee.com/xiaozhuo_Q/images/raw/master/blog/image-20210113223224391.png" alt="image-20210113223224391" /></p>
<h3 id="dict-字典哈希表"><a class="markdownIt-Anchor" href="#dict-字典哈希表"></a> Dict 字典/哈希表</h3>
<p>dict字典的底层是使用哈希表实现的，通过这哈希表可以高效的完成键值的关联与对键值对的管理。</p>
<p>而哈希表就是多个哈希桶构成的数组。每个键值对根据键的哈希值存储在相应的哈希桶中，存储在相同哈希桶的键值对的哈希节点通过链地址法连接。因而每个键值对节点都有指向对应key，val，以及下一个节点的指针。</p>
<p><img src="https://gitee.com/xiaozhuo_Q/images/raw/master/blog/image-20210118105401587.png" alt="image-20210118105401587" /></p>
<p>那么作为一个哈希表，重点往往在散列函数，哈希冲突，扩容机制这几个点。</p>
<p><strong>散列函数</strong>的作用在于计算哈希key最终存储在哪个哈希槽上，因此散列函数的算法除了效率还需要尽可能的将每个节点均匀地分散到哈希槽上，让散列尽可能的均匀。</p>
<p>redis在字典中具体使用散列的算法是 Murmurhash2。Murmurhash2是一种非加密hash算法，相对其他哈希散列算法。</p>
<blockquote>
<p><em>这种算法即使输入的键是有规律的，算法仍能给出一个很好的随机分布性，计算速度非常快，使用简单。</em></p>
</blockquote>
<p><strong>哈希冲突</strong> 当多个哈希节点被分配到同一个哈希槽时就会产生哈希冲突，在redis中就使用链地址法来解决，每个节点都有一个next指针来连接下一个节点，用链地址的形式连接多个节点在同一个哈希槽上现成一个单向链表，每加入一个新的节点时，由于每个哈希槽指针只指向链表的表头，所以是使用头插法，插入到链表的表头位置。</p>
<p><strong>渐近式rehash</strong></p>
<p>由于当哈希表内所保存的哈希节点越来越多时，就需要对哈希表的大小进行扩容，通过增加哈希桶的方式，使整个哈希表的负载因子（used/size）即每一个哈希桶内链表的个数在一个合理的范围。扩容的具体方式就用上了dict结构下的rehashidx变量与ht数组中另一个哈希表了。那么具体是如何进行渐进式rehash的呢？</p>
<ol>
<li>
<p>为另一个空闲的新哈希表分配空间。空间大小为&gt;= 两倍旧哈希表所承载节点的2^n次方。（收缩时为一倍）</p>
</li>
<li>
<p>将rehashidx由默认值-1设为0；开始渐进式rehash。</p>
</li>
<li>
<p>每当对字典进行操作时，除了执行原本的操作还会将旧哈希表rehashidx索引对应的哈希槽内所有的哈希节点进行rehash（重新计算哈希值并根据新哈希表大小计算出在新哈希表的哈希槽）到新的哈希表。然后rehashidx++；</p>
</li>
<li>
<p>当对旧哈希表所有的键值对都rehash到新的哈希表时重新将rehashidx设为-1.</p>
</li>
<li>
<p>释放的哈希表。将指向旧哈希表的指针指向新的哈希表，为原本新哈希表指针指向一个新的哈希表。这样整个渐进式rehash过程就完成了。</p>
<p>这种渐进式rehash的方式保证了每一次的哈希表rehash的量不会过多，时间不会过久阻塞了单线程的redis。</p>
<p>rehash的扩容触发条件会根据redis是否有在创建子进程（BGSAVE与BGREWRITEAOF）而改变。当有进行创建子进程的操作时，只有负载因子大于5才会进行rehash扩容否则只需大于1就可以进行rehash了。当负载因子小于0.1就会进行缩小。</p>
<p>在渐进式rehash期间对字典的所有操作都会针对新旧哈希表进行操作的。</p>
</li>
</ol>
<h3 id="skiplist-跳跃表"><a class="markdownIt-Anchor" href="#skiplist-跳跃表"></a> skiplist 跳跃表</h3>
<p>​	Redis使用跳跃表(skiplist)作为有序集合键的底层实现之一。skiplist本质上也是一种查找结构，用于解决算法中的查找问题（Searching）。一般查找问题的解法分为两个大类：一个是基于各种平衡树，一个是基于哈希表。但skiplist却比较特殊，它没法归属到这两大类里面。因为他是基于链表实现的。算是分治查找使用链表，在牺牲空间复杂度情况下产生的结构。</p>
<p>​	传统意义的单链表是一个线性结构。像有序的链表中大部分操作例如：插入，查找 都是需要一个O(n)的时间；</p>
<p><img src="http://images.zhuoke.xyz/img/20150530162529554" alt="img" /></p>
<p>​	先来看看skiplist比较基础的结构图，使用上图中所看到的的跳跃表。由于我们能够先通过每一个节点的最上层的指针先进行查找，将查找的值与目前节点的后继节点的值进行对比，如果大于则继续与后继指针对比，否则就下沉一层然后继续循环，直到找到该值在跳跃表的位置。（最后一定下沉到最下层）这样子就能跳过大部分的节点。然后再缩减范围，对以下一层的指针进行查找，若仍未找到，缩小范围继续查找。通过在每个节点增加多个后继指针就能够大大降低降低查找所需时间。原本O（n）也降低到O(logn);</p>
<p>基于redis是一种内存数据库，所以像使用B+tree实现索引这一类的数据结构只使用于存储在磁盘的mysql之类的数据库。基于哈希表又不满足数据库多样的需求，Redis 中的有序集合支持的核心操作主要有下面这几个：</p>
<ul>
<li>插入一个数据</li>
<li>删除一个数据</li>
<li>查找一个数据</li>
<li>按照区间查找数据（比如查找在[100,356]之间的数据）</li>
<li>迭代输出有序序列</li>
</ul>
<p>其中，插入、查找、删除以及迭代输出有序序列这几个操作，红黑树也能完成，时间复杂度和跳表是一样的，但是，按照区间来查找数据这个操作，红黑树的效率没有跳表高。</p>
<h3 id="sds-简单动态字符串"><a class="markdownIt-Anchor" href="#sds-简单动态字符串"></a> SDS 简单动态字符串</h3>
<p>关于String类型底层的数据结构，虽然redis是使用c编写的，但是String并没有用c语言的字符串来实现。而是使用了一种简单动态字符串（simple dynamic string），即SDS作为Redis默认字符串的数据结构。<strong>SDS</strong></p>
<p>用于在以下方面</p>
<ul>
<li>
<p>数据库的字符串</p>
</li>
<li>
<p>缓冲区（AOF模块的AOF缓冲区；客户端状态的输入缓冲区）</p>
<p>可以看到SDS被大量应用在数据快速修改的场景。而C字符串长度每一次增加或减少都会程序都需要进行一次内存重分配。而SDS结构则进行了优化。类似于ArrayList，通过一些冗余空间来减少内存重新分配的次数，我们先来看一下SDS的结构。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">struct sdshdr &#123;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;字符串长度</span><br><span class="line"></span><br><span class="line">   int len;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;空闲字节</span><br><span class="line"></span><br><span class="line">   int free;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;实际存储数据buf的char型数组</span><br><span class="line"></span><br><span class="line">    char buf[];</span><br><span class="line">&#125;;      </span><br></pre></td></tr></table></figure>
<p>SDS整个结构还是相对比较简单明了，直接存储了字符串的长度以及另外存储数组空闲字节</p>
<p>，这样设计就可以<strong>直接获得字符串长度</strong>，而不用遍历到空字符；另外使得存储数据的buf数组不用跟c字符串一样，强制使数据量与存储数据的数组容量一致，实现<strong>空间预分配</strong>与<strong>惰性空间</strong>释放大大减少了数据变化后内存空间重分配的次数。虽然SDS与C字符串一样以空字符结尾，但是SDS的APi都是二进制安全的，不但可以<strong>避免缓冲区溢出</strong>而且<strong>可以使用原本C&lt;string.h&gt;中部分函数</strong>。还可以保存二进制数据(图片，音视频等文件)。</p>
</li>
</ul>
<h4 id="命令"><a class="markdownIt-Anchor" href="#命令"></a> 命令</h4>
<ul>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/string/set.html">SET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/get.html">GET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/setnx.html">SETNX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/setex.html">SETEX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/psetex.html">GETEX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/getset.html">GETSET</a>    获取赋值</li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/string/append.html">APPEND</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/setrange.html">SETRANGE</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/getrange.html">GETRANGE</a>   局部修改</li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/string/incr.html">INCR</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/incrby.html">INCRBY</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/incrbyfloat.html">INCRBYFLOAT</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/decr.html">DECR</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/decrby.html">DECRBY</a> 增量/减量</li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/string/mset.html">MSET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/msetnx.html">MSETNX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/string/mget.html">MGET</a> 批量操作</li>
</ul>
<h3 id="hash"><a class="markdownIt-Anchor" href="#hash"></a> Hash</h3>
<h4 id="命令-2"><a class="markdownIt-Anchor" href="#命令-2"></a> 命令</h4>
<ul>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hset.html">HSET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hsetnx.html">HSETNX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hget.html">HGET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hkeys.html">HKEYS</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hvals.html">HVALS</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hexists.html">HEXISTS</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hdel.html">HDEL</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hlen.html">HLEN</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hstrlen.html">HSTRLEN</a>   对field 单独的操作</li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hincrby.html">HINCRBY</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hincrbyfloat.html">HINCRBYFLOAT</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hmset.html">HMSET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hmget.html">HMGET</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/hash/hgetall.html">HGETALL</a></li>
</ul>
<h3 id="list"><a class="markdownIt-Anchor" href="#list"></a> List</h3>
<p>命令</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/lpush.html">LPUSH</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/lpushx.html">LPUSHX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/rpush.html">RPUSH</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/rpushx.html">RPUSHX</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/lpop.html">LPOP</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/rpop.html">RPOP</a>/<a target="_blank" rel="noopener" href="http://redisdoc.com/list/rpoplpush.html">RPOPLPUSH</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/lrem.html">LREM</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/llen.html">LLEN</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/lindex.html">LINDEX</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/linsert.html">LINSERT</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/lset.html">LSET</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/lrange.html">LRANGE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/ltrim.html">LTRIM</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/blpop.html">BLPOP</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/brpop.html">BRPOP</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/list/brpoplpush.html">BRPOPLPUSH</a></li>
</ul>
<p>Set</p>
<h4 id="命令-3"><a class="markdownIt-Anchor" href="#命令-3"></a> 命令</h4>
<ul>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sadd.html">SADD</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sismember.html">SISMEMBER</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/spop.html">SPOP</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/srandmember.html">SRANDMEMBER</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/srem.html">SREM</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/smove.html">SMOVE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/scard.html">SCARD</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/smembers.html">SMEMBERS</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sscan.html">SSCAN</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sinter.html">SINTER</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sinterstore.html">SINTERSTORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sunion.html">SUNION</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sunionstore.html">SUNIONSTORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sdiff.html">SDIFF</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/set/sdiffstore.html">SDIFFSTORE</a></li>
</ul>
<h3 id="sorted-sets"><a class="markdownIt-Anchor" href="#sorted-sets"></a> sorted sets</h3>
<p>命令</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zadd.html">ZADD</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zscore.html">ZSCORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zincrby.html">ZINCRBY</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zcard.html">ZCARD</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zcount.html">ZCOUNT</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrange.html">ZRANGE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrevrange.html">ZREVRANGE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrangebyscore.html">ZRANGEBYSCORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrevrangebyscore.html">ZREVRANGEBYSCORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrank.html">ZRANK</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrevrank.html">ZREVRANK</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrem.html">ZREM</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zremrangebyrank.html">ZREMRANGEBYRANK</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zremrangebyscore.html">ZREMRANGEBYSCORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zrangebylex.html">ZRANGEBYLEX</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zlexcount.html">ZLEXCOUNT</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zremrangebylex.html">ZREMRANGEBYLEX</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zscan.html">ZSCAN</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zunionstore.html">ZUNIONSTORE</a></li>
<li><a target="_blank" rel="noopener" href="http://redisdoc.com/sorted_set/zinterstore.html">ZINTERSTORE</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">浊客</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/">http://example.com/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">浊客的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/redis/">redis</a></div><div class="post_share"><div class="social-share" data-image="https://download.logo.wine/logo/Redis/Redis-Logo.wine.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/25/screw%E4%B8%80%E9%94%AE%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E6%A1%A3/"><img class="prev-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">screw一键自动生成数据库文档</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/22/C++/"><img class="next-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info"></div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2020/06/27/nIY1saEj87i5Vg9.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">浊客</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/GayHub1"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text"> Redis入坑笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFredis%E6%9F%A5%E7%9C%8B%E6%BA%90%E5%9B%BE%E5%83%8F"><span class="toc-number">1.1.</span> <span class="toc-text"> 什么是Redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text"> Redis安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#windows%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.1.</span> <span class="toc-text"> Windows安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#linux%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Linux安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> docker安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> 编译安装</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8redis%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 使用redis客户端连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text"> 常用命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text"> 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dict-%E5%AD%97%E5%85%B8%E5%93%88%E5%B8%8C%E8%A1%A8"><span class="toc-number">1.4.1.</span> <span class="toc-text"> Dict 字典&#x2F;哈希表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skiplist-%E8%B7%B3%E8%B7%83%E8%A1%A8"><span class="toc-number">1.4.2.</span> <span class="toc-text"> skiplist 跳跃表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sds-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.4.3.</span> <span class="toc-text"> SDS 简单动态字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.3.1.</span> <span class="toc-text"> 命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash"><span class="toc-number">1.4.4.</span> <span class="toc-text"> Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4-2"><span class="toc-number">1.4.4.1.</span> <span class="toc-text"> 命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#list"><span class="toc-number">1.4.5.</span> <span class="toc-text"> List</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4-3"><span class="toc-number">1.4.5.1.</span> <span class="toc-text"> 命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sorted-sets"><span class="toc-number">1.4.6.</span> <span class="toc-text"> sorted sets</span></a></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/12/11/%E5%B9%B4%E6%9C%AB%E7%9A%84%E7%A2%8E%E7%A2%8E%E5%8F%A8%E5%8F%A8/" title="年末的碎碎叨叨"><img src="https://gitee.com/xiaozhuo_Q/images/raw/master/blog/1607616796059.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="年末的碎碎叨叨"/></a><div class="content"><a class="title" href="/2020/12/11/%E5%B9%B4%E6%9C%AB%E7%9A%84%E7%A2%8E%E7%A2%8E%E5%8F%A8%E5%8F%A8/" title="年末的碎碎叨叨">年末的碎碎叨叨</a><time datetime="2020-12-10T16:02:15.000Z" title="发表于 2020-12-11 00:02:15">2020-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/25/SpringBoot%E6%97%A5%E5%BF%97/" title="SpringBoot日志"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot日志"/></a><div class="content"><a class="title" href="/2020/11/25/SpringBoot%E6%97%A5%E5%BF%97/" title="SpringBoot日志">SpringBoot日志</a><time datetime="2020-11-25T14:58:08.000Z" title="发表于 2020-11-25 22:58:08">2020-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/25/screw%E4%B8%80%E9%94%AE%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E6%A1%A3/" title="screw一键自动生成数据库文档"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="screw一键自动生成数据库文档"/></a><div class="content"><a class="title" href="/2020/11/25/screw%E4%B8%80%E9%94%AE%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E6%A1%A3/" title="screw一键自动生成数据库文档">screw一键自动生成数据库文档</a><time datetime="2020-11-25T14:49:35.000Z" title="发表于 2020-11-25 22:49:35">2020-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/" title="Redis入坑笔记"><img src="https://download.logo.wine/logo/Redis/Redis-Logo.wine.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis入坑笔记"/></a><div class="content"><a class="title" href="/2020/11/23/Redis%E5%85%A5%E5%9D%91%E7%AC%94%E8%AE%B0/" title="Redis入坑笔记">Redis入坑笔记</a><time datetime="2020-11-22T16:04:02.000Z" title="发表于 2020-11-23 00:04:02">2020-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/22/C++/" title="无题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/22/C++/" title="无题">无题</a><time datetime="2020-11-22T10:07:26.416Z" title="发表于 2020-11-22 18:07:26">2020-11-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2021 By 浊客</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action"><img class="icp-icon" src="/img/icp.png" alt="ICP"/><span>粤ICP备20058715号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'hxN4EMnnWWFNeyk4xbNxQJT7-gzGzoHsz',
      appKey: 'lewYKS5k1rb7D5sVgI4QeTAx',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><script src="xxxx"></script></div></body></html>